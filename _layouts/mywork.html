<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
{% include head.html %}
</head>

<body id="mywork" onload="getRepos()">

{% include navigation.html %}

<div id="main" role="main">
  <article class="entry">
    {% if page.image.feature %}<img src="{{ site.url }}/images/{{ page.image.feature }}" class="entry-feature-image" alt="{{ page.title }}" {% if site.logo == null %}style="margin-top:0;"{% endif %}>{% if page.image.credit %}<p class="image-credit">Photo Credit: <a href="{{ page.image.creditlink }}">{{ page.image.credit }}</a></p>{% endif %}{% endif %}
    <div class="entry-wrapper">
      <header class="entry-header">
        <h1 class="entry-title">{% if page.headline %}{{ page.headline }}{% else %}{{ page.title }}{% endif %}</h1>
      </header>
      <div class="entry-content">
        {{ content }}
        <ul id="repos">
        </ul>
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    {% include footer.html %}
  </footer>
</div><!-- /.footer-wrapper -->

{% include scripts.html %}

<script>
function getRepos(){
	var xhr = new XMLHttpRequest();

	xhr.open("GET","https://api.github.com/users/pimonteiro/repos", true);
	xhr.send(null);


	xhr.onreadystatechange = function(){
		if (xhr.readyState === 4 && (xhr.status === 200 || xhr.status === 304)){
		  listRepos(xhr.responseText);

		}
		else console.log(xhr.status);
	}

}

function listRepos(data){
	var parsedData = JSON.parse(data);
	var listDiv = document.getElementById('repos');
	var ul = document.createElement('ul');

	console.log(parsedData.length);
	for(var i=0; i < parsedData.length; i++){
		console.log(parsedData[i]);
	  var name = parsedData[i].name;
	  var isFork = parsedData[i].fork;
	  var url = parsedData[i].html_url;
	  var description = parsedData[i].description;

	  var li = document.createElement('li');
	  var a = document.createElement('a');
	  a.href = url;

	  li.innerHTML = name + " --> " + description;
	  a.appendChild(li);
	  ul.appendChild(a);
	}
	listDiv.appendChild(ul);
}

</script>

</body>
</html>
